<x-card>
  <div>
      <input type="range" min="0" max="360" step="1" value="{{alpha}}">
  </div>
  <div>
      <input type="text" value="{{nbeta}}">
      <input type="range" min="-180" max="180" step="1" value="{{beta}}">
  </div>
  <div>
      <input type="text" value="{{Math.round(gamma+60)}}">
      <input type="range" min="-90" max="90" step="1" value="{{gamma}}">
  </div>
<script>
  console.log('opts', this.opts)
  var blockSend = [];
  var lastSent=[];
  
  
  function msend(arg){
    if (lastSent[arg[0]+':'+arg[1]] === arg[2]) return;
    lastSent[arg[0]+':'+arg[1]] = arg[2];
  
    if (!blockSend[arg[0]+':'+arg[1]] ){ 
      midiOut.send(arg);
      blockSend[arg[0]+':'+arg[1]] = 1;
      setInterval(()=>{
        blockSend[arg[0]+':'+arg[1]] = 0;
      }, 50);    
    }
  }
  
  this.opts.socket.on('o', function(msg){
    // console.log('orientation', msg)
    beta = msg.beta;
    gamma = msg.gamma;
    alpha = msg.alpha;
    ngamma = Math.round(Math.max(Math.min(gamma+60, 127),0))
    nbeta = Math.min(
        Math.max(
          (parseInt(beta)+5), 
        0),
      127)
    xCard.update();
    

      // msend([176, 1, nbeta]);
      msend([176, 2, ngamma]);
   

  });
</script>
</x-card>